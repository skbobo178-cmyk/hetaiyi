<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Compressor üñºÔ∏è</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #1a1a2e; color: #fff; min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 30px; color: #00d4ff; }
        .upload { background: #16213e; padding: 40px; border-radius: 12px; text-align: center; border: 2px dashed #333; }
        .upload:hover { border-color: #00d4ff; }
        input[type="file"] { display: none; }
        .upload-btn { background: #00d4ff; color: #1a1a2e; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-weight: bold; display: inline-block; }
        .options { background: #16213e; padding: 20px; border-radius: 12px; margin-top: 20px; display: none; }
        .options.show { display: block; }
        .slider { margin: 15px 0; }
        .slider label { display: block; margin-bottom: 8px; }
        input[type="range"] { width: 100%; }
        .preview { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .preview img { max-width: 100%; border-radius: 8px; }
        .preview-box { background: #16213e; padding: 15px; border-radius: 12px; }
        .preview-box h3 { color: #00d4ff; margin-bottom: 10px; font-size: 14px; }
        .download { background: #238636; color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 20px; width: 100%; }
        .download:hover { background: #2ea043; }
        .stats { text-align: center; margin-top: 10px; color: #888; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üñºÔ∏è Image Compressor</h1>
        <div class="upload" onclick="document.getElementById('file').click()">
            <input type="file" id="file" accept="image/*" onchange="handleFile()">
            <div class="upload-btn">Select Image</div>
            <p style="margin-top:15px;color:#888">Click or drag image here</p>
        </div>
        <div class="options" id="options">
            <div class="slider">
                <label>Quality: <span id="qualityVal">80</span>%</label>
                <input type="range" id="quality" min="10" max="100" value="80" oninput="document.getElementById('qualityVal').textContent=this.value;compress()">
            </div>
            <div class="slider">
                <label>Max Width: <span id="widthVal">1920</span>px</label>
                <input type="range" id="maxWidth" min="300" max="3840" value="1920" step="100" oninput="document.getElementById('widthVal').textContent=this.value;compress()">
            </div>
            <div class="preview">
                <div class="preview-box">
                    <h3>Original</h3>
                    <img id="original">
                    <p class="stats" id="originalStats"></p>
                </div>
                <div class="preview-box">
                    <h3>Compressed</h3>
                    <img id="compressed">
                    <p class="stats" id="compressedStats"></p>
                </div>
            </div>
            <button class="download" onclick="download()">Download Compressed Image</button>
        </div>
    </div>
    <script>
        let originalFile = null;
        let compressedBlob = null;
        
        function handleFile() {
            const file = document.getElementById('file').files[0];
            if (!file) return;
            originalFile = file;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('original').src = e.target.result;
                document.getElementById('originalStats').textContent = formatSize(file.size);
                document.getElementById('options').classList.add('show');
                compress();
            };
            reader.readAsDataURL(file);
        }
        
        function compress() {
            const img = new Image();
            img.onload = function() {
                const canvas = document.createElement('canvas');
                const maxWidth = parseInt(document.getElementById('maxWidth').value);
                let width = img.width;
                let height = img.height;
                
                if (width > maxWidth) {
                    height = (height * maxWidth) / width;
                    width = maxWidth;
                }
                
                canvas.width = width;
                canvas.height = height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);
                
                canvas.toBlob(function(blob) {
                    compressedBlob = blob;
                    const url = URL.createObjectURL(blob);
                    document.getElementById('compressed').src = url;
                    document.getElementById('compressedStats').textContent = formatSize(blob.size);
                }, 'image/jpeg', parseInt(document.getElementById('quality').value) / 100);
            };
            img.src = document.getElementById('original').src;
        }
        
        function formatSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
        }
        
        function download() {
            if (!compressedBlob) return;
            const a = document.createElement('a');
            a.href = URL.createObjectURL(compressedBlob);
            a.download = 'compressed_' + originalFile.name.replace(/\.[^/.]+$/, '') + '.jpg';
            a.click();
        }
    </script>
</body>
</html>
