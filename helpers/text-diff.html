<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÄ Text Diff / Compare</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1a2e; color: #eee; min-height: 100vh; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #888; margin-bottom: 30px; }
        .card { background: #16213e; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .compare-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        textarea { width: 100%; background: #0f0f23; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 8px; font-size: 13px; min-height: 200px; resize: vertical; font-family: 'Monaco', 'Menlo', monospace; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #aaa; }
        button { background: #e94560; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: transform 0.1s; }
        button:hover { transform: scale(1.02); }
        .btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 15px; }
        .btn-secondary { background: #4a4a6a; }
        
        .diff-output { background: #0f0f23; border-radius: 8px; margin-top: 15px; overflow: hidden; }
        .diff-line { padding: 6px 12px; font-family: monospace; font-size: 13px; display: flex; }
        .diff-line.added { background: rgba(74, 222, 128, 0.15); color: #4ade80; }
        .diff-line.removed { background: rgba(255, 107, 107, 0.15); color: #ff6b6b; }
        .diff-line.unchanged { color: #888; }
        .line-num { min-width: 40px; color: #666; user-select: none; }
        .line-content { flex: 1; white-space: pre-wrap; word-break: break-all; }
        .line-prefix { min-width: 20px; }
        
        .stats { display: flex; gap: 20px; margin-top: 15px; font-size: 14px; }
        .stat { padding: 8px 16px; background: #0f0f23; border-radius: 6px; }
        .stat-added { color: #4ade80; }
        .stat-removed { color: #ff6b6b; }
        
        .mode-toggle { display: flex; gap: 10px; margin-bottom: 15px; }
        .mode-toggle button { flex: 1; }
        .mode-toggle button.active { background: #e94560; }
        .mode-toggle button:not(.active) { background: #4a4a6a; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÄ Text Diff / Compare</h1>
        <p class="subtitle">Compare two texts and see the differences</p>
        
        <div class="card">
            <div class="mode-toggle">
                <button class="active" onclick="setMode('lines')" id="modeLines">Line by Line</button>
                <button onclick="setMode('words')" id="modeWords">Word by Word</button>
                <button onclick="setMode('chars')" id="modeChars">Character</button>
            </div>
            
            <div class="compare-grid">
                <div>
                    <label>Original Text:</label>
                    <textarea id="text1" placeholder="Paste original text here..."></textarea>
                </div>
                <div>
                    <label>Modified Text:</label>
                    <textarea id="text2" placeholder="Paste modified text here..."></textarea>
                </div>
            </div>
            
            <div class="btn-row">
                <button onclick="compare()">üîç Compare</button>
                <button class="btn-secondary" onclick="swapTexts()">‚áÖ Swap</button>
                <button class="btn-secondary" onclick="clearAll()">üóëÔ∏è Clear</button>
            </div>
        </div>
        
        <div class="card" id="resultCard" style="display:none;">
            <div class="stats">
                <div class="stat stat-added">+ Added: <span id="addedCount">0</span></div>
                <div class="stat stat-removed">- Removed: <span id="removedCount">0</span></div>
                <div class="stat">Total: <span id="totalChanges">0</span></div>
            </div>
            
            <div class="diff-output" id="diffOutput"></div>
        </div>
    </div>

    <script>
        let compareMode = 'lines';
        
        function setMode(mode) {
            compareMode = mode;
            document.querySelectorAll('.mode-toggle button').forEach(b => b.classList.remove('active'));
            document.getElementById('mode' + mode.charAt(0).toUpperCase() + mode.slice(1)).classList.add('active');
        }
        
        function compare() {
            const text1 = document.getElementById('text1').value;
            const text2 = document.getElementById('text2').value;
            
            let diff = [];
            if (compareMode === 'lines') {
                diff = diffLines(text1, text2);
            } else if (compareMode === 'words') {
                diff = diffWords(text1, text2);
            } else {
                diff = diffChars(text1, text2);
            }
            
            renderDiff(diff);
        }
        
        function diffLines(text1, text2) {
            const lines1 = text1.split('\n');
            const lines2 = text2.split('\n');
            const result = [];
            
            // Simple LCS-based diff
            const lcs = longestCommonSubsequence(lines1, lines2);
            
            let i1 = 0, i2 = 0, iLcs = 0;
            while (i1 < lines1.length || i2 < lines2.length) {
                if (iLcs < lcs.length && i1 < lines1.length && lines1[i1] === lcs[iLcs] && i2 < lines2.length && lines2[i2] === lcs[iLcs]) {
                    result.push({ type: 'unchanged', content: lines1[i1] });
                    i1++; i2++; iLcs++;
                } else if (i2 < lines2.length && (iLcs >= lcs.length || lines2[i2] !== lcs[iLcs])) {
                    result.push({ type: 'added', content: lines2[i2] });
                    i2++;
                } else if (i1 < lines1.length && (iLcs >= lcs.length || lines1[i1] !== lcs[iLcs])) {
                    result.push({ type: 'removed', content: lines1[i1] });
                    i1++;
                }
            }
            return result;
        }
        
        function diffWords(text1, text2) {
            const words1 = text1.split(/(\s+)/);
            const words2 = text2.split(/(\s+)/);
            
            const lcs = longestCommonSubsequence(words1, words2);
            const result = [];
            
            let i1 = 0, i2 = 0, iLcs = 0;
            while (i1 < words1.length || i2 < words2.length) {
                if (iLcs < lcs.length && i1 < words1.length && words1[i1] === lcs[iLcs] && i2 < words2.length && words2[i2] === lcs[iLcs]) {
                    result.push({ type: 'unchanged', content: words1[i1] });
                    i1++; i2++; iLcs++;
                } else if (i2 < words2.length && (iLcs >= lcs.length || words2[i2] !== lcs[iLcs])) {
                    result.push({ type: 'added', content: words2[i2] });
                    i2++;
                } else if (i1 < words1.length && (iLcs >= lcs.length || words1[i1] !== lcs[iLcs])) {
                    result.push({ type: 'removed', content: words1[i1] });
                    i1++;
                }
            }
            return result;
        }
        
        function diffChars(text1, text2) {
            const chars1 = text1.split('');
            const chars2 = text2.split('');
            
            const lcs = longestCommonSubsequence(chars1, chars2);
            const result = [];
            
            let i1 = 0, i2 = 0, iLcs = 0;
            while (i1 < chars1.length || i2 < chars2.length) {
                if (iLcs < lcs.length && i1 < chars1.length && chars1[i1] === lcs[iLcs] && i2 < chars2.length && chars2[i2] === lcs[iLcs]) {
                    result.push({ type: 'unchanged', content: chars1[i1] });
                    i1++; i2++; iLcs++;
                } else if (i2 < chars2.length && (iLcs >= lcs.length || chars2[i2] !== lcs[iLcs])) {
                    result.push({ type: 'added', content: chars2[i2] });
                    i2++;
                } else if (i1 < chars1.length && (iLcs >= lcs.length || chars1[i1] !== lcs[iLcs])) {
                    result.push({ type: 'removed', content: chars1[i1] });
                    i1++;
                }
            }
            return result;
        }
        
        function longestCommonSubsequence(arr1, arr2) {
            const m = arr1.length, n = arr2.length;
            const dp = Array(m + 1).fill(null).map(() => Array(n + 1).fill(0));
            
            for (let i = 1; i <= m; i++) {
                for (let j = 1; j <= n; j++) {
                    if (arr1[i-1] === arr2[j-1]) {
                        dp[i][j] = dp[i-1][j-1] + 1;
                    } else {
                        dp[i][j] = Math.max(dp[i-1][j], dp[i][j-1]);
                    }
                }
            }
            
            const result = [];
            let i = m, j = n;
            while (i > 0 && j > 0) {
                if (arr1[i-1] === arr2[j-1]) {
                    result.unshift(arr1[i-1]);
                    i--; j--;
                } else if (dp[i-1][j] > dp[i][j-1]) {
                    i--;
                } else {
                    j--;
                }
            }
            return result;
        }
        
        function renderDiff(diff) {
            let added = 0, removed = 0;
            const html = diff.map((d, i) => {
                if (d.type === 'added') added++;
                if (d.type === 'removed') removed++;
                const prefix = d.type === 'added' ? '+' : d.type === 'removed' ? '-' : ' ';
                return `<div class="diff-line ${d.type}"><span class="line-num">${i+1}</span><span class="line-prefix">${prefix}</span><span class="line-content">${escapeHtml(d.content)}</span></div>`;
            }).join('');
            
            document.getElementById('diffOutput').innerHTML = html;
            document.getElementById('addedCount').textContent = added;
            document.getElementById('removedCount').textContent = removed;
            document.getElementById('totalChanges').textContent = added + removed;
            document.getElementById('resultCard').style.display = 'block';
        }
        
        function escapeHtml(text) {
            return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }
        
        function swapTexts() {
            const t1 = document.getElementById('text1').value;
            const t2 = document.getElementById('text2').value;
            document.getElementById('text1').value = t2;
            document.getElementById('text2').value = t1;
        }
        
        function clearAll() {
            document.getElementById('text1').value = '';
            document.getElementById('text2').value = '';
            document.getElementById('resultCard').style.display = 'none';
        }
    </script>
</body>
</html>
