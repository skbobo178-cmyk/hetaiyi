<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚è∞ Cron Expression Parser</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1a2e; color: #eee; min-height: 100vh; padding: 20px; }
        .container { max-width: 700px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #888; margin-bottom: 30px; }
        .card { background: #16213e; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .cron-input { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .cron-field { flex: 1; min-width: 80px; }
        .cron-field input { width: 100%; background: #0f0f23; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 8px; font-size: 18px; text-align: center; font-family: monospace; }
        .cron-field label { display: block; text-align: center; font-size: 12px; color: #888; margin-bottom: 5px; }
        .quick-presets { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; }
        .preset { background: #0f0f23; border: 1px solid #333; color: #aaa; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; transition: all 0.2s; }
        .preset:hover { border-color: #e94560; color: #fff; }
        button { background: #e94560; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: transform 0.1s; }
        button:hover { transform: scale(1.02); }
        .btn-secondary { background: #4a4a6a; }
        .result { background: #0f0f23; padding: 15px; border-radius: 8px; margin-top: 15px; }
        .result-title { color: #aaa; font-size: 13px; margin-bottom: 10px; }
        .result-value { font-family: monospace; font-size: 16px; color: #4ade80; margin-bottom: 15px; }
        .next-runs { margin-top: 15px; }
        .run-item { padding: 8px 12px; background: #16213e; border-radius: 6px; margin-bottom: 8px; font-size: 14px; }
        .run-time { color: #fff; }
        .run-relative { color: #888; font-size: 12px; margin-left: 10px; }
        .human-readable { color: #e94560; font-size: 15px; line-height: 1.6; }
        .help { font-size: 12px; color: #666; margin-top: 15px; }
        .help code { background: #0f0f23; padding: 2px 6px; border-radius: 4px; color: #aaa; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚è∞ Cron Expression Parser</h1>
        <p class="subtitle">Parse cron expressions and see next run times</p>
        
        <div class="card">
            <label>Cron Expression:</label>
            <div class="cron-input">
                <div class="cron-field"><label>Minute</label><input type="text" id="minute" value="*" placeholder="*"></div>
                <div class="cron-field"><label>Hour</label><input type="text" id="hour" value="*" placeholder="*"></div>
                <div class="cron-field"><label>Day</label><input type="text" id="day" value="*" placeholder="*"></div>
                <div class="cron-field"><label>Month</label><input type="text" id="month" value="*" placeholder="*"></div>
                <div class="cron-field"><label>Weekday</label><input type="text" id="weekday" value="*" placeholder="*"></div>
            </div>
            
            <label>Quick Presets:</label>
            <div class="quick-presets">
                <button class="preset" onclick="applyPreset('* * * * *')">Every minute</button>
                <button class="preset" onclick="applyPreset('0 * * * *')">Every hour</button>
                <button class="preset" onclick="applyPreset('0 0 * * *')">Daily midnight</button>
                <button class="preset" onclick="applyPreset('0 9 * * *')">Daily 9 AM</button>
                <button class="preset" onclick="applyPreset('0 9 * * 1-5')">Weekdays 9 AM</button>
                <button class="preset" onclick="applyPreset('0 0 * * 0')">Weekly Sunday</button>
                <button class="preset" onclick="applyPreset('0 0 1 * *')">Monthly 1st</button>
            </div>
            
            <button onclick="parseCron()">üîç Parse & Calculate</button>
        </div>
        
        <div class="card" id="resultCard" style="display:none;">
            <div class="result-title">Human Readable:</div>
            <div class="human-readable" id="humanReadable"></div>
            
            <div class="result-title" style="margin-top:20px;">Next 10 Runs:</div>
            <div class="next-runs" id="nextRuns"></div>
        </div>
        
        <div class="card">
            <div class="help">
                <strong>Syntax:</strong><br>
                <code>*</code> any value &nbsp; <code>,</code> value list &nbsp; <code>-</code> range &nbsp; <code>/</code> step<br><br>
                <strong>Examples:</strong><br>
                <code>0/15 * * * *</code> - Every 15 minutes<br>
                <code>0 9-17 * * *</code> - Every hour 9-5<br>
                <code>0 0 1,15 * *</code> - 1st and 15th of month<br>
            </div>
        </div>
    </div>

    <script>
        const fieldNames = ['minute', 'hour', 'day', 'month', 'weekday'];
        const fieldRanges = [[0,59], [0,23], [1,31], [1,12], [0,6]];
        
        function applyPreset(expr) {
            const parts = expr.split(' ');
            parts.forEach((val, i) => {
                if (i < 5) document.getElementById(fieldNames[i]).value = val;
            });
            parseCron();
        }
        
        function parseField(value, min, max) {
            const result = new Set();
            if (value === '*') {
                for (let i = min; i <= max; i++) result.add(i);
            } else if (value.includes('/')) {
                const [range, step] = value.split('/');
                const stepNum = parseInt(step);
                let start = min, end = max;
                if (range !== '*') {
                    if (range.includes('-')) {
                        [start, end] = range.split('-').map(Number);
                    } else {
                        start = parseInt(range);
                    }
                }
                for (let i = start; i <= end; i += stepNum) result.add(i);
            } else if (value.includes(',')) {
                value.split(',').forEach(part => {
                    if (part.includes('-')) {
                        const [a, b] = part.split('-').map(Number);
                        for (let i = a; i <= b; i++) result.add(i);
                    } else {
                        result.add(parseInt(part));
                    }
                });
            } else if (value.includes('-')) {
                const [a, b] = value.split('-').map(Number);
                for (let i = a; i <= b; i++) result.add(i);
            } else {
                result.add(parseInt(value));
            }
            return Array.from(result).filter(n => n >= min && n <= max).sort((a,b) => a-b);
        }
        
        function getFieldValues() {
            return fieldNames.map((name, i) => {
                const val = document.getElementById(name).value.trim();
                return val ? parseField(val, fieldRanges[i][0], fieldRanges[i][1]) : [fieldRanges[i][0]];
            });
        }
        
        function humanReadable() {
            const [min, hour, day, month, wd] = fieldNames.map(n => document.getElementById(n).value);
            let desc = '';
            
            // Time
            if (min === '*' && hour === '*') desc += 'Every minute';
            else if (min === '0' && hour === '*') desc += 'Every hour';
            else if (hour === '*') desc += `At minute ${min} of every hour`;
            else if (min === '0') desc += `At ${hour}:00`;
            else desc += `At ${hour}:${min.padStart(2,'0')}`;
            
            // Day
            if (day !== '*' || month !== '*' || wd !== '*') {
                if (day === '*' && month === '*') {
                    const wdNames = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
                    if (wd.includes('-')) {
                        const [a,b] = wd.split('-').map(Number);
                        desc += `, ${wdNames[a]}-${wdNames[b]}`;
                    } else if (wd === '1-5') desc += ', Monday-Friday (weekdays)';
                    else if (wd === '0,6') desc += ', weekends';
                    else desc += `, ${wdNames[parseInt(wd)]}`;
                } else if (day !== '*') {
                    desc += `, on day ${day}`;
                }
                if (month !== '*') {
                    const monthNames = ['','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
                    desc += `, in ${monthNames[parseInt(month)]}`;
                }
            }
            
            return desc;
        }
        
        function getNextRuns() {
            const [minVals, hourVals, dayVals, monthVals, wdVals] = getFieldValues();
            const runs = [];
            const now = new Date();
            let d = new Date(now);
            d.setSeconds(0);
            d.setMilliseconds(0);
            
            // Check next 2 years
            for (let i = 0; i < 730 * 24 * 60 && runs.length < 10; i++) {
                d.setMinutes(d.getMinutes() + 1);
                
                const m = d.getMinutes();
                const h = d.getHours();
                const dt = d.getDate();
                const mon = d.getMonth() + 1;
                const w = d.getDay();
                
                if (minVals.includes(m) && hourVals.includes(h) && 
                    (dayVals.includes(dt) || wdVals.includes(w)) && monthVals.includes(mon)) {
                    runs.push(new Date(d));
                }
            }
            return runs;
        }
        
        function formatRelative(date) {
            const now = new Date();
            const diff = date - now;
            const mins = Math.floor(diff / 60000);
            const hours = Math.floor(mins / 60);
            const days = Math.floor(hours / 24);
            
            if (mins < 60) return `${mins} min`;
            if (hours < 24) return `${hours}h ${mins % 60}m`;
            return `${days}d ${hours % 24}h`;
        }
        
        function parseCron() {
            try {
                const hr = humanReadable();
                document.getElementById('humanReadable').textContent = hr;
                
                const runs = getNextRuns();
                const html = runs.map((r, i) => {
                    const options = { weekday: 'short', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };
                    return `<div class="run-item"><span class="run-time">${r.toLocaleString('en-US', options)}</span><span class="run-relative">+${formatRelative(r)}</span></div>`;
                }).join('');
                document.getElementById('nextRuns').innerHTML = html;
                
                document.getElementById('resultCard').style.display = 'block';
            } catch (e) {
                alert('Error parsing cron: ' + e.message);
            }
        }
        
        // Initialize with default
        parseCron();
    </script>
</body>
</html>
